@use "custom-properties" as *;

// ==========================================================================
// Content typography â€” Minor Second modular scale (1.067)
// ==========================================================================

:root {

    // ----------------------------------------------------------------------
    // Font families
    // ----------------------------------------------------------------------

    // Title / display usage
    --font-sans-title:
        "Alegreya Sans",
        "Source Sans 3",
        "Segoe UI",
        Roboto,
        "Helvetica Neue",
        Arial,
        sans-serif;

    // Condensed face used for headings
    --font-sans-heading:
        "Roboto Condensed",
        "Roboto",
        "Helvetica Neue",
        Arial,
        sans-serif;

    // Primary body font optimized for readability
    --font-sans-body:
        "Roboto",
        "Helvetica Neue",
        Arial,
        sans-serif;

    // Serif font for quotations and long-form typographic contrast
    --font-serif:
        "Source Serif",
        Georgia,
        "Times New Roman",
        Times,
        serif;

    // Small caps serif variant
    --font-serif-sc:
        "Alegreya SC",
        Georgia,
        "Times New Roman",
        Times,
        serif;

    // Monospace font for code and technical content
    --font-mono:
        ui-monospace,
        SFMono-Regular,
        Menlo,
        Monaco,
        Consolas,
        "Liberation Mono",
        monospace;

    // ----------------------------------------------------------------------
    // Modular scale definition
    // ----------------------------------------------------------------------

    // Base font size; changing this scales the entire typographic system
    --ms-step-0: 1rem;

    // Minor Second ratio produces subtle typographic hierarchy
    --ms-ratio: 1.067;

    // Downward scale
    --ms-step--1: calc(var(--ms-step-0) / var(--ms-ratio));
    --ms-step--2: calc(var(--ms-step--1) / var(--ms-ratio));
    --ms-step--3: calc(var(--ms-step--2) / var(--ms-ratio));
    --ms-step--4: calc(var(--ms-step--3) / var(--ms-ratio));

    // Upward scale
    --ms-step-1: calc(var(--ms-step-0) * var(--ms-ratio));
    --ms-step-2: calc(var(--ms-step-1) * var(--ms-ratio));
    --ms-step-3: calc(var(--ms-step-2) * var(--ms-ratio));
    --ms-step-4: calc(var(--ms-step-3) * var(--ms-ratio));
    --ms-step-5: calc(var(--ms-step-4) * var(--ms-ratio));
    --ms-step-6: calc(var(--ms-step-5) * var(--ms-ratio));
    --ms-step-7: calc(var(--ms-step-6) * var(--ms-ratio));
    --ms-step-8: calc(var(--ms-step-7) * var(--ms-ratio));
    --ms-step-9: calc(var(--ms-step-8) * var(--ms-ratio));

    // ----------------------------------------------------------------------
    // Font weights
    // ----------------------------------------------------------------------

    --fw-light: 300;
    --fw-regular: 400;
    --fw-medium: 500;
    --fw-semibold: 600;
    --fw-bold: 700;

    // ----------------------------------------------------------------------
    // Line heights
    // ----------------------------------------------------------------------

    // Tight line-height for headings
    --lh-tight: 1.15;

    // Body line-height controls baseline rhythm
    --lh-body: 1.6;

    // ----------------------------------------------------------------------
    // Baseline rhythm system
    // ----------------------------------------------------------------------

    // Baseline unit derived from body font size and line-height
    --baseline: calc(var(--ms-step-0) * var(--lh-body));

    // Spacing scale derived from baseline
    --space-1: calc(var(--baseline) * 0.25);
    --space-2: calc(var(--baseline) * 0.5);
    --space-3: calc(var(--baseline) * 0.75);
    --space-4: var(--baseline);
    --space-5: calc(var(--baseline) * 1.5);
    --space-6: calc(var(--baseline) * 2);
}

// ==========================================================================
// Root typography initialization
// ==========================================================================

html,
body {
    background-color: var(--color-bg);

    // Establish base size for modular scale
    font-size: var(--ms-step-0);
}

// Establish global body font
body {
    font-family: var(--font-sans-body);
    line-height: var(--lh-body);
    color: var(--color-text-primary);
}

// ==========================================================================
// Splash / index
// ==========================================================================

#index main h1 {
    font-family: var(--font-serif);
    font-size: var(--ms-step-9);
    font-weight: var(--fw-semibold);
    text-align: center;
}

// ==========================================================================
// Main content grid
// ==========================================================================

.page-grid {

    // Headings use condensed face
    :is(h1, h2, h3, h4, h5, h6) {
        font-family: var(--font-sans-heading);
        color: var(--color-text-heading);
        line-height: var(--lh-tight);
        text-wrap: balance;
    }

    h1 {
        font-weight: var(--fw-semibold);
        font-size: var(--ms-step-8);
        text-align: center;
        margin-block-start: var(--space-6);
    }

    h2 {
        font-weight: var(--fw-medium);
        font-size: var(--ms-step-6);
        margin-block-start: var(--space-4);
    }

    h3 {
        font-weight: var(--fw-regular);
        font-size: var(--ms-step-4);
        margin-block-start: var(--space-4);
    }

    h4 {
        font-weight: var(--fw-regular);
        font-size: var(--ms-step-2);
        margin-block-start: var(--space-4);
    }

    h5 {
        font-weight: var(--fw-regular);
        font-size: var(--ms-step-1);
        margin-block-start: var(--space-4);
    }

    h6 {
        font-weight: var(--fw-regular);
        font-size: var(--ms-step-0);
        margin-block-start: var(--space-4);
    }

    // Spacing following headings
    h1 + * {
        margin-block-start: var(--space-5);
    }

    h1 + section {
        margin-block-start: 0;
    }

    h2 + * {
        margin-block-start: var(--space-3);
    }

    h3 + * {
        margin-block-start: var(--space-2);
    }

    h4 + *,
    h5 + *,
    h6 + * {
        margin-block-start: var(--space-1);
    }

    // Body text
    p {
        font-family: var(--font-sans-body);
        font-size: var(--ms-step-0);
        line-height: var(--lh-body);
        font-weight: var(--fw-light);
        text-wrap: pretty;
    }

    // Lists use body font for readability
    :is(ul, ol) {
        font-family: var(--font-sans-body);
        font-size: var(--ms-step--1);
        line-height: var(--lh-body);
        font-weight: var(--fw-regular);
    }

    ul {
        list-style: disc outside;
        margin-inline-start: 1.25rem;
    }

    ol {
        list-style: decimal outside;
        margin-inline-start: 1.5rem;
    }

    li > ul,
    li > ol {
        margin-block: var(--space-1);
    }

    // Definition lists
    dl {
        dt {
            font-family: var(--font-sans-body);
            font-size: var(--ms-step-0);
            font-weight: var(--fw-regular);
        }

        dd {
            font-family: var(--font-sans-body);
            font-size: var(--ms-step-0);
            font-weight: var(--fw-light);
            margin-block-start: var(--space-1);

            & + dt {
                margin-block-start: var(--space-3);
            }
        }
    }

    // Blockquotes
    blockquote {
        font-family: var(--font-serif);
        font-style: italic;
        font-size: var(--ms-step-0);
        line-height: var(--lh-body);
        color: var(--color-text-secondary);
        margin-inline-start: var(--space-3);
        padding-inline-start: var(--space-3);
        border-inline-start: 3px solid var(--figure-border-color);

        .blockquote-footer {
            font-family: var(--font-sans-body);
            font-size: var(--ms-step--1);
            font-weight: var(--fw-regular);
            margin-block-start: var(--space-2);
            text-align: right;
        }

        @media (min-width: $desktop-sm) {
            font-size: var(--ms-step-1);
        }
    }

    // Figures
    figure {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: var(--space-2);
        background-color: var(--figure-bg-color);
    }

    figure > img {
        border: 1px solid var(--figure-border-color);
    }

    figure:has(img.portrait) {
        grid-column: content;
    }

    figcaption {
        font-family: var(--font-sans-body);
        font-size: var(--ms-step--1);
        line-height: var(--lh-body);
        color: var(--color-text-muted);
        align-self: flex-start;
    }

    // Code blocks
    code {
        font-family: var(--font-mono);
        font-size: 0.95em;
    }

    pre {
        max-width: 100%;
        overflow-x: auto;
        background-color: var(--color-code-bg);
        padding: var(--space-2);
        border-radius: 0.5rem;
    }

    pre code {
        font-size: var(--ms-step--1);
        color: var(--color-code-fg);
    }

    // Maps
    div[id*="map"] {
        margin-block: var(--space-4);
    }
}