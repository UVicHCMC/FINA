@use "custom-properties" as *;

/* ==========================================================================
   Content typography — Minor Second modular scale (1.067)
   ========================================================================== */

/*
   Modular scale system
   --------------------

   This file defines a complete typographic scale using the Minor Second ratio.

   The scale is anchored to a single base size (--ms-step-0). Every other size
   is derived mathematically from that value.

   Benefits of this approach:

   - All font sizes remain proportionally related
   - Global resizing is achieved by changing only one variable
   - Typographic hierarchy remains consistent across the system
   - Eliminates arbitrary font-size values scattered throughout the codebase

   Naming convention:

     --ms-step-0   = base size (body text)
     --ms-step-1   = one step larger
     --ms-step-2   = two steps larger
     --ms-step--1  = one step smaller
     etc.

   This produces a predictable, structured typographic system.
*/

:root {
    // ----------------------------------------------------------------------
    // Font families
    // ----------------------------------------------------------------------

    --font-sans-title: "Alegreya Sans", "Source Sans 3", "Segoe UI", Roboto,
        "Helvetica Neue", Arial, sans-serif;

    --font-sans: "Roboto", Verdana, Geneva, Tahoma, sans-serif;

    --font-serif: "Source Serif", Georgia, "Times New Roman", Times, serif;

    --font-serif-sc: "Alegreya SC", Georgia, "Times New Roman", Times, serif;

    --font-mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;

    // ----------------------------------------------------------------------
    // Modular scale core definition
    // ----------------------------------------------------------------------

    /*
       Base size of the entire typographic system.

       This value defines body text size and serves as the reference point
       for all derived sizes.

       Changing this value scales the entire system proportionally.
    */
    --ms-step-0: 1rem;

    /*
       Minor Second ratio.

       Each step is 1.067 times larger than the previous step.

       This produces subtle hierarchy suitable for long-form reading.
    */
    --ms-ratio: 1.067;

    // ----------------------------------------------------------------------
    // Downward scale (smaller text sizes)
    // ----------------------------------------------------------------------

    --ms-step--1: calc(var(--ms-step-0) / var(--ms-ratio));
    --ms-step--2: calc(var(--ms-step--1) / var(--ms-ratio));
    --ms-step--3: calc(var(--ms-step--2) / var(--ms-ratio));
    --ms-step--4: calc(var(--ms-step--3) / var(--ms-ratio));
    --ms-step--5: calc(var(--ms-step--4) / var(--ms-ratio));
    --ms-step--6: calc(var(--ms-step--5) / var(--ms-ratio));

    // ----------------------------------------------------------------------
    // Upward scale (larger text sizes)
    // ----------------------------------------------------------------------

    --ms-step-1: calc(var(--ms-step-0) * var(--ms-ratio));
    --ms-step-2: calc(var(--ms-step-1) * var(--ms-ratio));
    --ms-step-3: calc(var(--ms-step-2) * var(--ms-ratio));
    --ms-step-4: calc(var(--ms-step-3) * var(--ms-ratio));
    --ms-step-5: calc(var(--ms-step-4) * var(--ms-ratio));
    --ms-step-6: calc(var(--ms-step-5) * var(--ms-ratio));
    --ms-step-7: calc(var(--ms-step-6) * var(--ms-ratio));
    --ms-step-8: calc(var(--ms-step-7) * var(--ms-ratio));
    --ms-step-9: calc(var(--ms-step-8) * var(--ms-ratio));

    // ----------------------------------------------------------------------
    // Font weights
    // ----------------------------------------------------------------------

    --fw-light: 300;
    --fw-regular: 400;
    --fw-medium: 500;
    --fw-semibold: 600;
    --fw-bold: 700;
    --fw-extra-bold: 800;
    --fw-black: 900;
    --fw-extra-black: 950;

    // ----------------------------------------------------------------------
    // Line heights
    // ----------------------------------------------------------------------

    /*
       Line-height controls vertical density and readability.

       Body line-height is used to derive vertical spacing rhythm.
    */
    --lh-tight: 1.15;
    --lh-body: 1.6;

    // ----------------------------------------------------------------------
    // Baseline rhythm system
    // ----------------------------------------------------------------------

    /*
       The baseline represents the vertical distance occupied by one line of body text.

       baseline = body font size × body line-height

       This value serves as the foundation for all vertical spacing, ensuring
       consistent visual rhythm across paragraphs, headings, and blocks.
    */
    --baseline: calc(var(--ms-step-0) * var(--lh-body));

    /*
       Spacing scale derived from the baseline.

       These values maintain alignment with the typographic rhythm.

       Using baseline-derived spacing ensures consistent visual flow and avoids
       arbitrary vertical gaps.
    */
    --space-1: calc(var(--baseline) * 0.25);
    --space-2: calc(var(--baseline) * 0.5);
    --space-3: calc(var(--baseline) * 0.75);
    --space-4: var(--baseline);
    --space-5: calc(var(--baseline) * 1.5);
    --space-6: calc(var(--baseline) * 2);
}

/* ==========================================================================
   Root typography initialization
   ========================================================================== */

html,
body {
    background-color: var(--color-bg);

    /*
       Establishes base font size for the entire modular scale.

       All rem values and scale steps are derived from this size.
    */
    font-size: var(--ms-step-0);
}

/* ==========================================================================
   Splash / index
   ========================================================================== */

#index main h1 {
    font-family: var(--font-serif);
    font-size: var(--ms-step-9);
    text-align: center;
}

/* ==========================================================================
   Main content grid
   ========================================================================== */

.page-grid {
    background-color: var(--color-bg);
    color: var(--color-text-primary);

    /*
       Shared heading styling.

       text-wrap: balance improves multi-line heading readability.
    */
    :is(h1, h2, h3, h4, h5, h6) {
        font-family: var(--font-sans);
        color: var(--color-text-heading);
        line-height: var(--lh-tight);
        text-wrap: balance;
    }

    // ----------------------------------------------------------------------
    // Heading hierarchy
    // ----------------------------------------------------------------------

    h1 {
        font-weight: var(--fw-bold);
        font-size: var(--ms-step-8);
        text-align: center;
        margin-block-start: var(--space-6);
    }

    h2 {
        font-weight: var(--fw-semibold);
        font-size: var(--ms-step-6);
        margin-block-start: var(--space-4);
    }

    h3 {
        font-weight: var(--fw-semibold);
        font-size: var(--ms-step-5);
        margin-block-start: var(--space-4);
    }

    h4 {
        font-weight: var(--fw-medium);
        font-size: var(--ms-step-4);
        margin-block-start: var(--space-4);
    }

    h5 {
        font-weight: var(--fw-medium);
        font-size: var(--ms-step-3);
        margin-block-start: var(--space-4);
    }

    h6 {
        font-weight: var(--fw-medium);
        font-size: var(--ms-step-2);
        margin-block-start: var(--space-4);
    }

    /*
       Spacing rules following headings.

       These values preserve vertical rhythm and visual grouping.
    */
    h1 + * {
        margin-block-start: var(--space-5);
    }

    h1 + section {
        margin-block-start: 0;
    }

    h2 + * {
        margin-block-start: var(--space-3);
    }

    h3 + * {
        margin-block-start: var(--space-2);
    }

    h4 + *,
    h5 + *,
    h6 + * {
        margin-block-start: var(--space-1);
    }

    // ----------------------------------------------------------------------
    // Body text
    // ----------------------------------------------------------------------

    p {
        font-family: var(--font-sans);
        font-size: var(--ms-step-0);
        line-height: var(--lh-body);
        font-weight: var(--fw-light);
        color: var(--color-text-primary);
        text-wrap: pretty;
    }

    // ----------------------------------------------------------------------
    // Links
    // ----------------------------------------------------------------------

    a,
    a:visited {
        color: var(--color-link);

        text-decoration: underline;
        text-underline-offset: var(--underline-offset);
        text-decoration-thickness: var(--underline-thickness);

        transition:
            color 0.25s ease,
            text-decoration-color 0.25s ease;

        overflow-wrap: anywhere;
    }

    a:hover,
    a:focus-visible {
        color: var(--color-link-hover);
        text-decoration-color: var(--underline-active);
    }

    // ----------------------------------------------------------------------
    // Vertical rhythm between block elements
    // ----------------------------------------------------------------------

    p + *,
    ul + *,
    ol + *,
    blockquote + * {
        margin-block-start: var(--space-4);
    }

    * + figure,
    * + video,
    figure + *,
    video + * {
        margin-block-start: var(--space-5);
    }

    // ----------------------------------------------------------------------
    // Blockquotes
    // ----------------------------------------------------------------------

    blockquote {
        font-family: var(--font-serif);
        font-style: italic;

        font-size: var(--ms-step-0);
        line-height: var(--lh-body);

        color: var(--color-text-secondary);

        margin-inline-start: var(--space-3);
        padding-inline-start: var(--space-3);

        border-inline-start: 3px solid var(--figure-border-color);

        .blockquote-footer {
            display: block;
            margin-block-start: var(--space-2);

            text-align: right;

            font-family: var(--font-sans);
            font-size: var(--ms-step--1);

            font-style: normal;
            color: var(--color-text-muted);
        }

        @media (min-width: $desktop-sm) {
            font-size: var(--ms-step-1);
        }
    }

    // ----------------------------------------------------------------------
    // Lists
    // ----------------------------------------------------------------------

    :is(ul, ol) {
        font-family: var(--font-sans);
        font-size: var(--ms-step--1);
        line-height: var(--lh-body);
        font-weight: var(--fw-regular);
    }

    ul {
        list-style: disc outside;
        margin-inline-start: 1.25rem;
    }

    ol {
        list-style: decimal outside;
        margin-inline-start: 1.5rem;
    }

    li > ul,
    li > ol {
        margin-block: var(--space-1);
    }

    // ----------------------------------------------------------------------
    // Definition lists
    // ----------------------------------------------------------------------

    dl {
        dt {
            font-family: var(--font-sans);
            font-size: var(--ms-step-0);
            font-weight: var(--fw-regular);
        }

        dd {
            font-family: var(--font-sans);
            font-size: var(--ms-step-0);
            font-weight: var(--fw-light);

            margin-block-start: var(--space-1);

            & + dt {
                margin-block-start: var(--space-3);
            }
        }
    }

    // ----------------------------------------------------------------------
    // Code blocks
    // ----------------------------------------------------------------------

    code {
        font-family: var(--font-mono);
        font-size: 0.95em;
    }

    pre {
        max-width: 100%;
        overflow-x: auto;

        background-color: var(--color-code-bg);

        padding: var(--space-2);
        border-radius: 0.5rem;
    }

    pre code {
        font-size: var(--ms-step--1);
        color: var(--color-code-fg);
    }

    // ----------------------------------------------------------------------
    // Figures
    // ----------------------------------------------------------------------

    figure {
        display: flex;
        flex-direction: column;
        align-items: center;

        gap: var(--space-2);

        background-color: var(--figure-bg-color);
    }

    figure > img {
        border: 1px solid var(--figure-border-color);
    }

    figure:has(img.portrait) {
        grid-column: content;
    }

    figcaption {
        font-family: var(--font-sans);
        font-size: var(--ms-step--1);
        line-height: var(--lh-body);

        color: var(--color-text-muted);

        align-self: flex-start;
    }

    // ----------------------------------------------------------------------
    // Maps
    // ----------------------------------------------------------------------

    div[id*="map"] {
        margin-block: var(--space-4);
    }
}